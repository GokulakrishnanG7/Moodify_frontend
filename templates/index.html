

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Moodify 2.0 - Emotion Reactor</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Share+Tech+Mono&display=swap');

    /* Splash screen styles */
    #splash {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    #splash img {
      width: 300px;
      height: auto;
      animation: fadeInOut 3s ease-in-out;
    }

    @keyframes fadeInOut {
      0% { opacity: 0; transform: scale(0.95); }
      10% { opacity: 1; transform: scale(1); }
      90% { opacity: 1; transform: scale(1); }
      100% { opacity: 0; transform: scale(1.05); }
    }

    :root {
      --bg-overlay: '';
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Share Tech Mono', monospace;
      color: #00ffcc;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      background: radial-gradient(circle, #0f0f0f 0%, #1a1a1a 100%);
      transition: background 1.2s ease;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: var(--bg-overlay);
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;
      opacity: 0.1;
      z-index: -1;
      animation: floatAnim 30s linear infinite;
      pointer-events: none;
      filter: brightness(1.2) contrast(1.2);
    }

    @keyframes floatAnim {
      0% { transform: translateY(0); }
      50% { transform: translateY(-30px); }
      100% { transform: translateY(0); }
    }

    .container {
      text-align: center;
      max-width: 850px;
      padding: 50px;
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid #00ffcc;
      border-radius: 20px;
      box-shadow: 0 0 50px rgba(0, 255, 204, 0.4), 0 0 25px rgba(0, 255, 204, 0.2) inset;
      backdrop-filter: blur(25px);
      animation: fadeIn 1.8s ease-out;
      display: none;
    }

    h1 {
      font-size: 4rem;
      margin-bottom: 20px;
      color: #00ffe7;
      font-family: 'Orbitron', sans-serif;
      text-shadow: 0 0 15px #00ffe7, 0 0 30px #00ffe7;
      letter-spacing: 2px;
    }

    p {
      font-size: 1.3rem;
      margin-bottom: 30px;
      color: #ffffffcc;
    }

    button {
      background: linear-gradient(to right, #8e2de2, #4a00e0);
      border: none;
      padding: 15px 45px;
      border-radius: 50px;
      color: #fff;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: 0 0 15px #8e2de2;
    }

    button:hover {
      background: linear-gradient(to right, #4a00e0, #8e2de2);
      transform: scale(1.1);
      box-shadow: 0 0 25px #8e2de2;
    }

    .output-box {
      margin-top: 30px;
      padding: 25px;
      background-color: rgba(255, 255, 255, 0.06);
      border-radius: 12px;
      border: 1px solid rgba(0, 255, 204, 0.4);
      color: #ffffffee;
      font-size: 1.2rem;
      line-height: 1.6;
    }

    .control-buttons {
      margin-top: 25px;
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .assistant-box {
      margin-top: 20px;
      padding: 15px 25px;
      max-width: 700px;
      text-align: center;
      font-size: 1.1rem;
      color: #00ffe7;
      background-color: rgba(0, 0, 0, 0.65);
      border: 1px solid #00ffe7;
      border-radius: 16px;
      box-shadow: 0 0 15px rgba(0, 255, 204, 0.3);
      font-family: 'Share Tech Mono', monospace;
      backdrop-filter: blur(15px);
      animation: fadeIn 1.2s ease-out;
      display: none;
    }

    .language-selector {
      margin-bottom: 25px;
      font-size: 1rem;
      color: #00ffe7;
    }

    .language-selector select {
      padding: 8px 15px;
      border-radius: 25px;
      background-color: #111;
      color: #00ffcc;
      border: 1px solid #00ffcc;
      font-size: 1rem;
      outline: none;
      transition: box-shadow 0.3s ease;
    }

    .language-selector select:hover {
      box-shadow: 0 0 10px #00ffe7;
      cursor: pointer;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.92); }
      to { opacity: 1; transform: scale(1); }
    }
  </style>
</head>
<body>
  <!-- Splash Screen -->
  <div id="splash">
    <img src="static/logo/logo.png" alt="Moodify Logo">
  </div>

  <!-- Main Container -->
  <div class="container" id="mainContainer">
    <h1 id="mainTitle">Moodify 2.0</h1>
    <p id="subtext">Let your face unlock a story hidden in your heart.<br>Tap below to begin your Emotion Journey.</p>

    <!-- ğŸŒ Language Selector -->
    <div class="language-selector">
      <label for="languageSelect">ğŸŒ Select Language:</label>
      <select id="languageSelect">
        <option value="en-US">English</option>
        <option value="ta-IN">Tamil</option>
        <option value="hi-IN">Hindi</option>
        <option value="te-IN">Telugu</option>
        <option value="ml-IN">Malayalam</option>
        <option value="de-DE">German</option>
        <option value="fr-FR">French</option>
        <option value="ja-JP">Japanese</option>
        <option value="zh-CN">Chinese</option>
        <option value="es-ES">Spanish</option>
      </select>
    </div>

    <!-- Main Buttons (No Design Change) -->
    <button id="startBtn" onclick="startMoodify()">Start Emotion Detection</button>
    <div class="control-buttons">
      <button id="detectBtn" onclick="startMoodify()">Detect Again</button>
      <button id="stopBtn" onclick="stopMusic()">Stop Music</button>
    </div>

    <div class="output-box" id="output">
      <p id="emotion"></p>
      <p id="story"></p>
    </div>
  </div>

  <div id="assistantBox" class="assistant-box"></div>

  <audio id="player" autoplay hidden>
    <source id="audioSource" src="" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>
  <script>
    // Splash screen timeout
    window.addEventListener("load", () => {
      setTimeout(() => {
        document.getElementById("splash").style.display = "none";
        document.getElementById("mainContainer").style.display = "block";
      }, 3000);
    });
  
    function changeBackgroundByEmotion(emotion) {
      const overlayPath = `/static/bg/${emotion}.svg`;
  
      const emotionThemes = {
        happy: 'radial-gradient(circle at center, #11B2BC,#1180BC)',
        sad: 'linear-gradient(to top, #1f1c2c, #928dab)',
        angry: 'linear-gradient(to right, #ff0844,#CE1212)',
        neutral: 'linear-gradient(to top, #bdc3c7, #2c3e50)',
        fear: 'linear-gradient(to top, #000428, #004e92)',
        surprise: 'linear-gradient(to top, #f7971e, #ffd200)',
        disgust: 'linear-gradient(to top, #a8e063, #56ab2f)',
      };
  
      document.body.style.background = emotionThemes[emotion] || 'radial-gradient(circle, #0f0f0f 0%, #1a1a1a 100%)';
      document.body.style.setProperty('--bg-overlay', `url(${overlayPath})`);
    }
  
    function getLangKey() {
      const fullLang = document.getElementById("languageSelect").value || 'en-US';
      return fullLang.split("-")[0];
    }
  
    function getVoiceLang() {
      return document.getElementById("languageSelect").value || 'en-US';
    }
  
    const translations = {
      en: {
        title: "Moodify 2.0",
        subtext: "Let your face unlock a story hidden in your heart.<br>Tap below to begin your Emotion Journey.",
        start: "Start Emotion Detection",
        detect: "Detect Again",
        stop: "Stop Music",
        assistant: {
          happy: "You're glowing today! Want a cheerful beat?",
          sad: "I'm here with you. Let's find peace together ğŸ’™",
          angry: "Deep breath pal. Let's calm the storm.",
          fear: "Courage isn't the absence of fear, it's acting despite it.",
          surprise: "Whoa! Didn't expect that? Neither did I!",
          neutral: "Staying chill... Want a soft background vibe?",
          disgust: "Letâ€™s purify this moment with calm.",
        }
      },
      ta: {
        title: "à®®à¯‚à®Ÿà®¿à®ªà¯ˆ 2.0",
        subtext: "à®‰à®™à¯à®•à®³à¯ à®®à¯à®•à®®à¯ à®‰à®™à¯à®•à®³à¯ à®‰à®³à¯à®³à®¤à¯à®¤à®¿à®©à¯ à®•à®¤à¯ˆà®¯à¯ˆ à®µà¯†à®³à®¿à®•à¯à®•à¯Šà®£à®³à¯à®®à¯.<br>à®¤à¯Šà®Ÿà®™à¯à®• à®•à¯€à®´à¯‡ à®¤à®Ÿà¯à®Ÿà®µà¯à®®à¯.",
        start: "à®‰à®£à®°à¯à®µà¯ à®•à®£à¯à®Ÿà®±à®¿à®¤à®²à¯ˆ à®¤à¯Šà®Ÿà®™à¯à®•à¯",
        detect: "à®®à¯€à®£à¯à®Ÿà¯à®®à¯ à®•à®£à¯à®Ÿà®±à®¿",
        stop: "à®‡à®šà¯ˆà®¯à¯ˆ à®¨à®¿à®±à¯à®¤à¯à®¤à¯",
        assistant: {
          happy: "à®‡à®©à¯à®±à¯ à®‰à®©à¯à®©à¯à®Ÿà¯ˆà®¯ à®®à¯à®•à®®à¯ à®’à®³à®¿à®°à¯à®•à®¿à®±à®¤à¯! à®®à®•à®¿à®´à¯à®šà¯à®šà®¿ à®ªà¯€à®Ÿà¯ à®µà¯‡à®£à¯à®Ÿà¯à®®à®¾?",
          sad: "à®¨à®¾à®©à¯ à®‰à®™à¯à®•à®³à¯à®Ÿà®©à¯ à®‡à®°à¯à®•à¯à®•à®¿à®±à¯‡à®©à¯. à®…à®®à¯ˆà®¤à®¿à®¯à¯ˆ à®¤à¯‡à®Ÿà¯à®µà¯‹à®®à¯ ğŸ’™",
          angry: "à®†à®´à¯à®¨à¯à®¤ à®®à¯‚à®šà¯à®šà¯ à®à®Ÿà¯à®•à¯à®•à®µà¯à®®à¯. à®•à¯‹à®ªà®¤à¯à®¤à¯ˆ à®šà®®à®¾à®³à®¿à®•à¯à®•à®²à®¾à®®à¯.",
          fear: "à®¤à¯ˆà®°à®¿à®¯à®®à¯ à®à®©à¯à®ªà®¤à¯ à®ªà®¯à®®à¯ à®‡à®²à¯à®²à®¾à®¤à®¤à®²à¯à®², à®…à®¤à¯ˆ à®à®¤à®¿à®°à¯à®•à¯Šà®³à¯à®µà®¤à¯à®¤à®¾à®©à¯.",
          surprise: "à®…à®ªà¯à®ªà®Ÿà®¿à®¯à®¾! à®à®¤à®¿à®°à¯à®ªà®¾à®°à¯à®•à¯à®•à®µà®¿à®²à¯à®²à¯ˆ!",
          neutral: "à®šà®¾à®¨à¯à®¤à®®à®¾à®• à®‡à®°à¯à®•à¯à®•à®¿à®±à¯‹à®®à¯... à®®à¯†à®©à¯à®®à¯ˆà®¯à®¾à®© à®‡à®šà¯ˆà®¯à®¾?",
          disgust: "à®‡à®¨à¯à®¤ à®¤à®°à¯à®£à®¤à¯à®¤à¯ˆ à®¨à®¿à®®à¯à®®à®¤à®¿à®¯à®¾à®• à®®à®¾à®±à¯à®±à¯à®µà¯‹à®®à¯."
        }
      },
      hi: {
        title: "à¤®à¥‚à¤¡à¤¿à¤«à¤¾à¤¯ 2.0",
        subtext: "à¤†à¤ªà¤•à¤¾ à¤šà¥‡à¤¹à¤°à¤¾ à¤†à¤ªà¤•à¥‡ à¤¦à¤¿à¤² à¤•à¥€ à¤•à¤¹à¤¾à¤¨à¥€ à¤¬à¤¤à¤¾à¤à¤—à¤¾à¥¤<br>à¤¶à¥à¤°à¥‚ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¨à¥€à¤šà¥‡ à¤Ÿà¥ˆà¤ª à¤•à¤°à¥‡à¤‚à¥¤",
        start: "à¤­à¤¾à¤µà¤¨à¤¾à¤“à¤‚ à¤•à¥€ à¤ªà¤¹à¤šà¤¾à¤¨ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚",
        detect: "à¤«à¤¿à¤° à¤¸à¥‡ à¤ªà¤¹à¤šà¤¾à¤¨à¥‡à¤‚",
        stop: "à¤¸à¤‚à¤—à¥€à¤¤ à¤°à¥‹à¤•à¥‡à¤‚",
        assistant: {
          happy: "à¤†à¤œ à¤¤à¥à¤® à¤–à¤¿à¤² à¤°à¤¹à¥‡ à¤¹à¥‹! à¤–à¥à¤¶ à¤®à¥à¤¯à¥‚à¤œà¤¿à¤• à¤¸à¥à¤¨à¥‡à¤‚?",
          sad: "à¤®à¥ˆà¤‚ à¤¤à¥à¤®à¥à¤¹à¤¾à¤°à¥‡ à¤¸à¤¾à¤¥ à¤¹à¥‚à¤à¥¤ à¤šà¤²à¥‹ à¤¶à¤¾à¤‚à¤¤à¤¿ à¤ªà¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚ ğŸ’™",
          angry: "à¤—à¤¹à¤°à¥€ à¤¸à¤¾à¤à¤¸ à¤²à¥‹à¥¤ à¤—à¥à¤¸à¥à¤¸à¥‡ à¤•à¥‹ à¤¶à¤¾à¤‚à¤¤ à¤•à¤°à¥‡à¤‚à¥¤",
          fear: "à¤¸à¤¾à¤¹à¤¸ à¤¡à¤° à¤•à¥€ à¤…à¤¨à¥à¤ªà¤¸à¥à¤¥à¤¿à¤¤à¤¿ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ, à¤‰à¤¸à¤•à¥‡ à¤¬à¤¾à¤µà¤œà¥‚à¤¦ à¤•à¤°à¤¨à¤¾ à¤¹à¥ˆà¥¤",
          surprise: "à¤“à¤¹! à¤¯à¥‡ à¤¨à¤¹à¥€à¤‚ à¤¸à¥‹à¤šà¤¾ à¤¥à¤¾! à¤®à¥ˆà¤‚ à¤­à¥€ à¤¨à¤¹à¥€à¤‚à¥¤",
          neutral: "à¤¶à¤¾à¤‚à¤¤ à¤¹à¥ˆà¤‚... à¤¸à¥‰à¤«à¥à¤Ÿ à¤®à¥à¤¯à¥‚à¤œà¤¿à¤• à¤šà¤¾à¤¹à¤¿à¤?",
          disgust: "à¤‡à¤¸ à¤ªà¤² à¤•à¥‹ à¤¸à¥à¤•à¥‚à¤¨ à¤®à¥‡à¤‚ à¤¬à¤¦à¤²à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤"
        }
      },
      // ğŸŸ¡ Add more: te, ml, de, fr, ja, zh, es
      te: {
      title: "à°®à±‚à°¡à°¿à°«à±ˆ 2.0",
      subtext: "à°®à±€ à°®à±à°–à°‚ à°®à±€ à°®à°¨à°¸à±à°²à±‹à°¨à°¿ à°•à°¥à°¨à± à°šà±†à°ªà±à°ªà±à°¤à±à°‚à°¦à°¿.<br>à°¤à°¦à±à°ªà°°à°¿ à°ªà±à°°à°¯à°¾à°£à°‚ à°®à±Šà°¦à°²à±à°ªà±†à°Ÿà±à°Ÿà°‚à°¡à°¿.",
      start: "à°­à°¾à°µ à°µà±à°¯à°•à±à°¤à±€à°•à°°à°£à°¨à± à°ªà±à°°à°¾à°°à°‚à°­à°¿à°‚à°šà°‚à°¡à°¿",
      detect: "à°®à°³à±à°²à±€ à°—à±à°°à±à°¤à°¿à°‚à°šà±",
      stop: "à°¸à°‚à°—à±€à°¤à°‚ à°†à°ªà±",
      assistant: {
        happy: "à°®à±€à°°à± à°µà±†à°²à°¿à°—à°¿à°ªà±‹à°¤à±à°¨à±à°¨à°¾à°°à±! à°‰à°¤à±à°¸à°¾à°¹à°­à°°à°¿à°¤à°®à±ˆà°¨ à°¸à°‚à°—à±€à°¤à°‚ à°µà°¿à°¨à°¾à°²à°¾?",
        sad: "à°¨à±‡à°¨à± à°®à±€à°¤à±‹à°¨à±‡ à°‰à°¨à±à°¨à°¾à°¨à±. à°®à°¨à°‚ à°¶à°¾à°‚à°¤à°¿à°¨à°¿ à°•à°¨à±à°—à±Šà°¨à°¦à°¾à°‚ ğŸ’™",
        angry: "à°† à°²à±‹à°¤à±ˆà°¨ à°¶à±à°µà°¾à°¸ à°¤à±€à°¸à±à°•à±‹à°‚à°¡à°¿. à°®à°¨à°‚ à°•à±‹à°ªà°¾à°¨à±à°¨à°¿ à°…à°¦à±à°ªà± à°šà±‡à°¦à±à°¦à°¾à°‚.",
        fear: "à°§à±ˆà°°à±à°¯à°‚ à°…à°‚à°Ÿà±‡ à°­à°¯à°‚ à°²à±‡à°¨à°¿à°¦à±‡ à°•à°¾à°¦à±, à°¦à°¾à°¨à±à°¨à°¿ à°…à°§à°¿à°—à°®à°¿à°‚à°šà°¡à°®à±‡.",
        surprise: "à°…à°¦à°¾! à°¨à±‡à°¨à± à°Šà°¹à°¿à°‚à°šà°²à±‡à°¦à±!",
        neutral: "à°“à°•à±‡... à°“ à°®à±†à°²à±‹à°¡à°¿ à°ªà°¾à°Ÿ à°¬à°¾à°—à±à°‚à°Ÿà±à°‚à°¦à°¾?",
        disgust: "à°ˆ à°•à±à°·à°£à°¾à°¨à±à°¨à°¿ à°¶à°¾à°‚à°¤à°‚à°—à°¾ à°®à°¾à°°à±à°šà±à°•à±à°‚à°¦à°¾à°‚."
      }
    },
    ml: {
      title: "à´®àµ‚à´¡à´¿à´«àµˆ 2.0",
      subtext: "à´¨à´¿à´¨àµà´±àµ† à´®àµà´–à´‚ à´¨à´¿à´¨àµà´±àµ† à´¹àµƒà´¦à´¯à´¤àµà´¤à´¿à´¨àµà´±àµ† à´•à´¥ à´ªà´±à´¯àµà´¨àµà´¨àµ.<br>à´¤àµà´Ÿà´™àµà´™à´¾àµ» à´¤à´¾à´´àµà´šà´¯à´¿àµ½ à´Ÿà´¾à´ªàµà´ªàµ à´šàµ†à´¯àµà´¯àµà´•.",
      start: "à´­à´¾à´µà´‚ à´¤à´¿à´°à´¿à´šàµà´šà´±à´¿à´¯àµ½ à´¤àµà´Ÿà´™àµà´™àµà´•",
      detect: "à´µàµ€à´£àµà´Ÿàµà´‚ à´¤à´¿à´°à´¿à´šàµà´šà´±à´¿à´¯àµà´•",
      stop: "à´¸à´‚à´—àµ€à´¤à´‚ à´¨à´¿àµ¼à´¤àµà´¤àµà´•",
      assistant: {
        happy: "à´¨àµ€ à´‡à´¨àµà´¨àµ à´ªàµà´°à´•à´¾à´¶à´¿à´•àµà´•àµà´¨àµà´¨àµ! à´¸à´¨àµà´¤àµ‹à´·à´‚ à´ªà´™àµà´•àµà´µàµ†à´•àµà´•à´¾à´¨àµ‹?",
        sad: "à´à´¾àµ» à´¨à´¿à´¨àµà´¨àµ‹à´ŸàµŠà´ªàµà´ªà´‚ à´¤à´¨àµà´¨àµ†. à´¨à´®àµà´•àµà´•àµ à´¸à´®à´¾à´§à´¾à´¨à´‚ à´•à´£àµà´Ÿàµ†à´¤àµà´¤à´¾à´‚ ğŸ’™",
        angry: "à´†à´´à´®à´¾à´¯ à´¶àµà´µà´¾à´¸à´‚ à´à´Ÿàµà´•àµà´•àµ‚. à´•àµ‹à´ªà´‚ à´•àµà´±à´¯àµà´•àµà´•à´¾à´‚.",
        fear: "à´§àµˆà´°àµà´¯à´‚ à´à´¨àµà´¨à´¤àµ à´­à´¯à´‚ à´‡à´²àµà´²à´¾à´¤à´¾à´•àµ½ à´…à´²àµà´², à´…à´¤à´¿à´¨àµ† à´¨àµ‡à´°à´¿à´Ÿà´²à´¾à´£àµ.",
        surprise: "à´…à´Ÿàµ‡! à´à´¾àµ» à´ªàµà´°à´¤àµ€à´•àµà´·à´¿à´šàµà´šà´¿à´²àµà´²!",
        neutral: "à´¨à´®àµà´•àµà´•àµ à´¶à´¾à´¨àµà´¤à´®à´¾à´¯ à´¸à´‚à´—àµ€à´¤à´‚ à´µàµ‡à´£à´®àµ‹?",
        disgust: "à´ˆ à´¨à´¿à´®à´¿à´·à´‚ à´¤àµà´¯à´œà´¿à´šàµà´šàµ à´ªàµà´¤à´¿à´¯à´¤à´¾à´•àµà´•à´¾à´‚."
      }
    },
    de: {
      title: "Moodify 2.0",
      subtext: "Dein Gesicht erzÃ¤hlt die Geschichte deines Herzens.<br>Tippe unten, um deine Reise zu beginnen.",
      start: "Emotionserkennung starten",
      detect: "Erneut erkennen",
      stop: "Musik stoppen",
      assistant: {
        happy: "Du strahlst heute! Lust auf einen frÃ¶hlichen Beat?",
        sad: "Ich bin bei dir. Lass uns Frieden finden ğŸ’™",
        angry: "Tief durchatmen. Lass uns den Sturm beruhigen.",
        fear: "Mut bedeutet, trotz Angst zu handeln.",
        surprise: "Wow! Damit habe ich nicht gerechnet!",
        neutral: "Ganz entspannt... Sanfte Musik gefÃ¤llig?",
        disgust: "Lass uns diesen Moment reinigen."
      }
    },
    fr: {
      title: "Moodify 2.0",
      subtext: "Ton visage rÃ©vÃ©lera lâ€™histoire de ton cÅ“ur.<br>Appuie ci-dessous pour commencer ton voyage Ã©motionnel.",
      start: "DÃ©marrer la dÃ©tection des Ã©motions",
      detect: "DÃ©tecter Ã  nouveau",
      stop: "ArrÃªter la musique",
      assistant: {
        happy: "Tu rayonnes aujourdâ€™hui ! Un peu de musique joyeuse ?",
        sad: "Je suis lÃ  pour toi. Trouvons la paix ensemble ğŸ’™",
        angry: "Respire profondÃ©ment. Apaisons la tempÃªte.",
        fear: "Le courage, câ€™est agir malgrÃ© la peur.",
        surprise: "Oh ! Je ne mâ€™y attendais pas non plus !",
        neutral: "Restons calmes... Un fond musical doux ?",
        disgust: "Purifions cet instant ensemble."
      }
    },
    ja: {
      title: "ãƒ ãƒ¼ãƒ‡ã‚£ãƒ•ã‚¡ã‚¤ 2.0",
      subtext: "ã‚ãªãŸã®é¡”ãŒå¿ƒã®ç‰©èªã‚’ä¼ãˆã¾ã™ã€‚<br>ä¸‹ã‚’ã‚¿ãƒƒãƒ—ã—ã¦æ„Ÿæƒ…ã®æ—…ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚",
      start: "æ„Ÿæƒ…æ¤œå‡ºã‚’é–‹å§‹",
      detect: "ã‚‚ã†ä¸€åº¦æ¤œå‡º",
      stop: "éŸ³æ¥½ã‚’åœæ­¢",
      assistant: {
        happy: "ä»Šæ—¥ã¯è¼ã„ã¦ã„ã¾ã™ã­ï¼æ¥½ã—ã„ãƒ“ãƒ¼ãƒˆã¯ã©ã†ï¼Ÿ",
        sad: "ç§ã¯ã‚ãªãŸã®ãã°ã«ã„ã¾ã™ã€‚ä¸€ç·’ã«å¹³å’Œã‚’è¦‹ã¤ã‘ã¾ã—ã‚‡ã† ğŸ’™",
        angry: "æ·±å‘¼å¸ã—ã¦ã€‚æ€’ã‚Šã‚’é®ã‚ã¾ã—ã‚‡ã†ã€‚",
        fear: "å‹‡æ°—ã¨ã¯ã€æã‚ŒãªãŒã‚‰ã‚‚è¡Œå‹•ã™ã‚‹ã“ã¨ã§ã™ã€‚",
        surprise: "ã‚ãŠï¼ç§ã‚‚ã³ã£ãã‚Šã—ã¾ã—ãŸï¼",
        neutral: "è½ã¡ç€ã„ã¦ã„ã¾ã™ã­...ç©ã‚„ã‹ãªéŸ³æ¥½ã¯ã©ã†ã§ã™ã‹ï¼Ÿ",
        disgust: "ã“ã®ç¬é–“ã‚’æµ„åŒ–ã—ã¾ã—ã‚‡ã†ã€‚"
      }
    },
    zh: {
      title: "æƒ…ç»ªå¼•æ“ 2.0",
      subtext: "ä½ çš„é¢éƒ¨å°†æ­ç¤ºä½ å†…å¿ƒçš„æ•…äº‹ã€‚<br>ç‚¹å‡»ä¸‹é¢å¼€å§‹ä½ çš„æƒ…ç»ªä¹‹æ—…ã€‚",
      start: "å¼€å§‹æƒ…ç»ªè¯†åˆ«",
      detect: "å†æ¬¡æ£€æµ‹",
      stop: "åœæ­¢éŸ³ä¹",
      assistant: {
        happy: "ä½ ä»Šå¤©å…‰å½©ç…§äººï¼æ¥ç‚¹å¼€å¿ƒçš„éŸ³ä¹å§ï¼Ÿ",
        sad: "æˆ‘åœ¨ä½ èº«è¾¹ã€‚æˆ‘ä»¬ä¸€èµ·å¯»æ‰¾å†…å¿ƒçš„å¹³é™ ğŸ’™",
        angry: "æ·±å‘¼å¸ã€‚è®©æˆ‘ä»¬å¹³æ¯æ€’ç«ã€‚",
        fear: "å‹‡æ°”ä¸æ˜¯æ²¡æœ‰ææƒ§ï¼Œè€Œæ˜¯ä»ç„¶å‰è¿›ã€‚",
        surprise: "å“‡å“¦ï¼æˆ‘ä¹Ÿæ²¡æƒ³åˆ°ï¼",
        neutral: "ä¿æŒå†·é™...è¦æ¥ç‚¹æŸ”å’Œçš„éŸ³ä¹å—ï¼Ÿ",
        disgust: "è®©æˆ‘ä»¬å‡€åŒ–è¿™ä¸€åˆ»å§ã€‚"
      }
    },
    es: {
      title: "Moodify 2.0",
      subtext: "Tu rostro revelarÃ¡ la historia de tu corazÃ³n.<br>Haz clic abajo para comenzar tu viaje emocional.",
      start: "Iniciar detecciÃ³n de emociones",
      detect: "Detectar de nuevo",
      stop: "Detener mÃºsica",
      assistant: {
        happy: "Â¡EstÃ¡s radiante hoy! Â¿QuÃ© tal un ritmo alegre?",
        sad: "Estoy contigo. Busquemos paz juntos ğŸ’™",
        angry: "Respira hondo. Vamos a calmar la tormenta.",
        fear: "El coraje no es la ausencia de miedo, es actuar a pesar de Ã©l.",
        surprise: "Â¡Wow! Â¡No me lo esperaba!",
        neutral: "Relajado... Â¿Quieres algo de mÃºsica suave?",
        disgust: "Purifiquemos este momento juntos."
      }
    },

    };
  
    function updateUIText() {
      const lang = getLangKey();
      const t = translations[lang] || translations["en"];
  
      document.getElementById("mainTitle").innerHTML = t.title;
      document.getElementById("subtext").innerHTML = t.subtext;
      document.getElementById("startBtn").innerText = t.start;
      document.getElementById("detectBtn").innerText = t.detect;
      document.getElementById("stopBtn").innerText = t.stop;
    }
  
    document.getElementById("languageSelect").addEventListener("change", updateUIText);
  
    function speakStory(story) {
      const synth = window.speechSynthesis;
      const utter = new SpeechSynthesisUtterance(story);
      utter.rate = 1;
      utter.pitch = 1;
      utter.lang = getVoiceLang();
      synth.cancel();
      synth.speak(utter);
    }
  
    function speakAssistant(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.rate = 1;
      utter.pitch = 1.1;
      utter.lang = getVoiceLang();
      speechSynthesis.cancel();
      speechSynthesis.speak(utter);
    }
  
    function stopMusic() {
      const audio = document.getElementById("player");
      audio.pause();
      audio.currentTime = 0;
    }
    async function startMoodify() {
    const emotionEl = document.getElementById("emotion");
    const storyEl = document.getElementById("story");
    const audio = document.getElementById("player");
    const audioSource = document.getElementById("audioSource");
    const assistantBox = document.getElementById("assistantBox");

    const langKey = getLangKey();
    const t = translations[langKey] || translations["en"];

    emotionEl.innerText = "â³ Detecting emotion... Please wait...";
    storyEl.innerText = "";
    assistantBox.style.display = "none";
    stopMusic();

    try {
      const langParam = document.getElementById("languageSelect").value;
      const response = await fetch(`/moodify?lang=${langParam}`);

      if (!response.ok) throw new Error("Failed to fetch response from server.");

      const data = await response.json();
      const emotion = data.emotion.toLowerCase();
      const story = data.story;

      emotionEl.innerText = `ğŸ§  Emotion Detected: ${emotion}`;
      storyEl.innerText = `ğŸ“– Story: ${story}`;

      changeBackgroundByEmotion(emotion);
      speakStory(story);

      const musicPath = `/static/music/${emotion}.mp3`;
      audioSource.src = musicPath;
      audio.load();
      audio.play();

      const assistantLine = t.assistant[emotion] || t.assistant["neutral"];
      assistantBox.textContent = assistantLine;
      assistantBox.style.display = "block";
      speakAssistant(assistantLine);

    } catch (error) {
      emotionEl.innerText = "âŒ Error detecting emotion.";
      storyEl.innerText = error.message;
      console.error("Fetch error:", error);
    }
  }

  // Set default language UI on load
  updateUIText();
</script>
</body>
</html>
  